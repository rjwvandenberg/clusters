# https://kubernetes.io/docs/reference/setup-tools/kubeadm/kubeadm-init/
# https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta3/
apiVersion: kubeadm.k8s.io/v1beta3
kind: InitConfiguration
nodeRegistration:
  criSocket: "unix:///run/containerd/containerd.sock" 
  kubeletExtraArgs: 
    node-labels: node.{{ k8s.domain }}/lifetime=persistent
skipPhases: 
  - addon/kube-proxy    # skip in favor of cilium
---
apiVersion: kubeadm.k8s.io/v1beta3
kind: ClusterConfiguration
controlPlaneEndpoint: {{ k8s.control_plane_endpoint }}
networking:
  dnsDomain: {{ k8s.dns_domain }}
